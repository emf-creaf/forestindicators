---
output: github_document
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>", fig.path = "README-")
knitr::opts_chunk$set(fig.path = "man/figures/")
```

# Indicators of forest stands

<!-- badges: start -->
  [![R-CMD-check](https://github.com/emf-creaf/forestindicators/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/emf-creaf/forestindicators/actions/workflows/R-CMD-check.yaml)
  <!-- badges: end -->
  
## Introduction

Package **forestindicators** is meant to assist the estimation of indicators (metrics) for forest stands, either derived from forest inventory data or forest model simulations. Most often, those indicators will estimate the provision of forest ecosystem services, but the package can be understood more generally as a platform to estimate forest metrics.

## Installation

Package **forestindicators** can be installed from GitHub using:
```{r installation github forestindicators, eval = FALSE}
remotes::install_github("emf-creaf/forestindicators")
```

## Examples

### Step 1: Choose target indicators and examine their requirements

The first step is to decide which indicators are to be estimated. You can examine the names of the indicators in the package that could be estimated with your data by calling function `available_indicators()`:

```{r}
library(forestindicators)
available_indicators(plant_dynamic_input = example_plant_dynamic_input)
```

We may need to check which data inputs are required, their units, etc. for a particular indicator. We can find this information using function `show_information()`, for example:

```{r}
show_information("live_tree_basal_area")
```


### Step 2: Assemble inputs and define values for additional parameters

Once the requested format and content of inputs is know, it is the responsibility of the user to build the necessary data frames to be used as inputs. We will normally need to define additional parameters to fine-tune the estimation of indicators, For that, we define a **named list** where each element corresponds to a different indicator and, in turn, contains a named list of parameters:

```{r}
params <- list(live_tree_basal_area = list(min_dbh = 8),
               live_tree_density = list(min_dbh = 8))
```

### Step 3: Call general estimation function

Once we have our inputs ready, the indicators are estimated by calling function `estimate_indicators()` as follows:

```{r}
res <- estimate_indicators(indicators = c("live_tree_basal_area", "live_tree_density"),
                           plant_dynamic_input = example_plant_dynamic_input,
                           additional_params = params)
```

The result of the estimation is the following:
```{r}
res
```

## Documentation and training

Two *vignettes* are included [here](https://emf-creaf.github.io/forestindicators/articles/) illustrate: (1) how to use the R package to estimate indicators; and (2) how to define new indicators.

## Volume/biomass allometric functions

Some of the indicators require the use of allometric relationships for *volume* or *biomass* estimation. Users of **forestindicators** can define their own functions for volume/biomass estimation and provide them to calls of `estimate_indicators()`. Alternatively, they can resort on additional packages and write wrapper functions. Even though it is not a strict requirement for **forestindicators**, applications of the package within Spain will be most useful if package [**IFNallometry**](https://emf-creaf.github.io/IFNallometry/index.html) is available, because it contains wrapper functions for *volume* or *biomass* estimation, which can be readily used when calculating forest indicators. Package **IFNallometry**  is also installed from GitHub using:

```{r installation github IFNallometry, eval = FALSE}
remotes::install_github("emf-creaf/IFNallometry")
```

## Authorship

Package **forestindicators** is developed and maintained by the [*Ecosystem Modelling Facility*](https://emf.creaf.cat) unit at [*CREAF*](https://www.creaf.cat/) (in Spain) and the *Landscape Modelling Group* at [*CTFC*](https://www.ctfc.cat/) (in Spain).

```{r, out.width='50%', fig.align="center", echo=FALSE}
knitr::include_graphics("man/figures/institution_logos.png")
```

## Funding

+ **Research project**: Improving the modelling of key forest dynamic
processes to forecast long-term changes in Mediterranean forests under climate change (IMPROMED). **Financial Entity**: Ministerio de Ciencia e Innovación (PID2023-152644NB-I00). **Duration from**: 01/09/2024 **to**: 31/08/2025. **PI**: Miquel De Cáceres/Josep Mª Espelta.

